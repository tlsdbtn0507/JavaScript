<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State">
    <ul class="suggestions">
      <li>Filter for a city</li>
      <li>or a state</li>
    </ul>
  </form>
<script>
const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';
//ë„ì‹œë“¤ì˜ ì •ë³´ê°€ ë‹´ê¸´ ì£¼ì†Œ

const cities =[];

fetch(endpoint)
    .then(blob => blob.json())//endpointì˜ ë°ì´í„°ë¥¼ ì •ë¦¬í•¨
    .then(data => cities.push(...data));//blob.json()ì´ ìƒˆë¡œìš´ promiseë¥¼ 
    //ìƒì„±í•´ì„œ ë˜ë‹¤ì‹œ thenì‚¬ìš©. ìœ„ì—ì„œ ë‚˜ì˜¨ dataë¥¼ citiesì— ë„£ê¸° ìœ„í•´ push  



//fetch(promise)ë¥¼ í™œìš©í•˜ê¸° ìœ„í•´ thenì„ ì‚¬ìš©
//thenì„ ì“°ë©´ ë¡œê·¸ ì¶œë ¥ì˜ ìˆœì„œë¥¼ ë°”ê¿€ ìˆ˜ ìˆìŒ

function findMatches(wordToMatch, cities){
    return cities.filter(place => {
        // ||ì€ ë‘˜ì¤‘ ì–´ëŠí•˜ë‚˜ê°€ trueë¼ë©´ true, ì—¬ê¸°ê¹Œì§€ ì‘ì„±í•˜ê³  ì½˜ì†”ì— 
        //findMatches('bos',cities) í•˜ë©´ {obj,obj} ì•ˆì— ë³´ìŠ¤í„´, ë³´ì‹œì— 
        //ì‹œí‹°ê°€ ë‚˜ì˜´
        const regex = new RegExp(wordToMatch, 'gi');//gi = glbal insensitive
        return place.city.match(regex) || place.state.match(regex)
        //city stateì— regexê°’(ì…ë ¥ê°’)ì´ ë‘˜ì¤‘ ì–´ëŠ í•˜ë‚˜ë¼ë„ ë§ëŠ”ë‹¤ë©´
        //ê²°ê³¼ë¥¼ ë³´ì—¬ì¤Œ
    });
}

function numberWithCommas(x){
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');
}

function displayMatches(){
    const matchArray = findMatches(this.value, cities);
    const html = matchArray.map(place => {
        const regex = new RegExp(this.value, 'gi');//RegExpë¥¼ í†µí•´ ì°¾ì€ ê°’ì„
        
        const cityName = place.city.replace(regex, `<span class="h1">${this.value}</span>`);
        const stateName = place.state.replace(regex, `<span class="h1">${this.value}</span>`);
        //ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ì°¾ì€ ê°’(this.value)ë§Œ ê°•ì¡°í•´ì£¼ëŠ” êµ¬ë¬¸
        //ex) bostì„ ê²€ìƒ‰í•˜ë©´ bostonì—ì„œ bostë§Œ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°
        return`
        <li>
            <span class="name">${cityName}, ${stateName}</span>
            <span class="population">${numberWithCommas(place.population)}</span>
        </li>
        `//ê²€ìƒ‰ í• ë•Œ ë°‘ì— ë‚´ë ¤ì˜¤ëŠ” suggestionë“¤ì— cityName/StateName/ì¸êµ¬ ë‚˜ì˜¤ê²Œí•¨
        ;
    }).join('');
    suggestions.innerHTML = html;
}

const searchInput = document.querySelector('.search');
const suggestions = document.querySelector('.suggestions');

searchInput.addEventListener('change', displayMatches);
//searchInputì˜ .searchê°€ changeí•˜ë©´ displayMatchesí•¨ìˆ˜ ì‹¤í–‰  
//displayMatchesê°€ ê²€ìƒ‰ í•œ ê²°ê³¼ê°€ ì½˜ì†”ì—ì„œ ëœ¬ë‹¤ í•˜ì§€ë§Œ ê¸ˆë°© ì‚¬ë¼ì§
searchInput.addEventListener('keyup',displayMatches);
//ê·¸ë¥¼ ëŒ€ë¹„í•˜ê¸° ìœ„í•´ keyupì´ ê³„ì† ê°ì§€ë˜ë©´ ê²€ìƒ‰ì˜ ê²°ê³¼ ìœ ì§€

</script>
</body>
</html>
